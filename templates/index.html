<!DOCTYPE html>
<html>
<head>
  <title>North Beach - Latest Conditions</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; background: #f7f9fa; }
    .section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 8px; background: #fff; }
    .section h2 { margin-top: 0; }
    ul { padding-left: 1.2em; }
  </style>
</head>
<body>
  <h1>North Beach - Latest Conditions</h1>
  <div id="conditions"></div>
  <div id="buoy"></div>
  <script>
    fetch('/wind_wave_data.json')
      .then(response => response.json())
      .then(data => {
        // TLDR section
        let TLDRhtml = '<div class="section"><h2>Tell Me What To Think Please</h2>';
        if (data.da_answer) {
          TLDRhtml += `<p>${data.da_answer}</p>`;
        } else {
          TLDRhtml += '<p>No decision data available.</p>';
        }
        TLDRhtml += '</div>';
        // METAR section
        const metarKey = Object.keys(data).find(k => k.startsWith("North Beach Conditions"));
        const metar = data[metarKey];
        let html = '<div class="section"><h2>Weather (Winds and Rain)</h2>';
        if (metar) {
          html += `<ul>
            <li><b>Receipt Time:</b> ${metar.receipt_time}</li>
            <li><b>Report Time (Zulu):</b> ${metar.report_time_zulu}</li>
            <li><b>Wind Speed:</b> ${metar.wind_speed_kts} kts</li>
            <li><b>Wind Direction:</b> ${metar.wind_direction_deg}Â° (${metar.wind_direction_text})</li>
            <li><b>Wind Gusts:</b> ${metar.wind_gusts_kts || 'N/A'} kts</li>
            <li><b>Rain Now:</b> ${metar.rain_now_in || 'N/A'} in</li>
            <li><b>Rain (3hr):</b> ${metar.rain_3hr_in || 'N/A'} in</li>
            <li><b>Rain (6hr):</b> ${metar.rain_6hr_in || 'N/A'} in</li>
            <li><b>Rain (24hr):</b> ${metar.rain_24hr_in || 'N/A'} in</li>
          </ul>`;
        } else if (data.metar_error) {
          html += `<p>Error: ${data.metar_error}</p>`;
        } else {
          html += '<p>No METAR data available.</p>';
        }
        html += '</div>';
        // Combine both and set once
        document.getElementById('conditions').innerHTML = TLDRhtml + html;

        // BUOY section
        let buoyHtml = '<div class="section"><h2>Buoy Data</h2>';
        if (data.buoy) {
          buoyHtml += `<p><b>Observed At:</b> ${data.buoy.observed_at}</p>`;
          buoyHtml += '<b>Summary:</b><ul>';
          data.buoy.summary.forEach(item => buoyHtml += `<li>${item}</li>`);
          buoyHtml += '</ul>';
          buoyHtml += '<b>Details:</b><ul>';
          data.buoy.details.forEach(item => buoyHtml += `<li>${item}</li>`);
          buoyHtml += '</ul>';
        } else if (data.buoy_error) {
          buoyHtml += `<p>Error: ${data.buoy_error}</p>`;
        } else {
          buoyHtml += '<p>No Buoy data available.</p>';
        }
        buoyHtml += '</div>';
        document.getElementById('buoy').innerHTML = buoyHtml;
      })
      .catch(err => {
        document.getElementById('conditions').innerHTML = `<p>Error loading data: ${err}</p>`;
      });
  </script>
</body>
<embed src="https://weathercams.faa.gov/cameras/state/US/cameraSite/760/details/camera/12782/full" style="width: 500px ; height: 500px">
</footer> <p> Made By: Andrew Claiborne and a ton of AI</p>
  <a href="https://www.ndbc.noaa.gov/station_page.php?station=51207">NOAA Buoy 51207 data found here<br> </a>
  <a href="https://aviationweather.gov/data/metar/?decoded=1&ids=PHNG&hours=24"> winds and rain are observed via MCAS from Aviation Weather Center via NWS found here <br> </a>
  <a href="mailto:andrew.m.claiborne@gmail.com"> any suggestions or feedback feel free to reach out!<br> </a>
  <a href="https://github.com/andrewmclaiborne-svg/what-is-nb-doing-heroku"> source code found here!</a>
</footer>

</html>
